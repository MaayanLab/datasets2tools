<!-- Object Cards -->
{% macro display_object_card(object_data, object_type) %}

	{% if object_type == 'dataset' %}
		{% set card_title = object_data.dataset_accession %}
		{% set card_source = 'Gene Expression Omnibus' %}
		{% set card_source_url = object_data.repository_homepage_url %}
		{% set card_description = object_data.dataset_title %}
		{% set card_icon_url = url_for('static', filename='icons/gene.png') %}
		{% set card_landing_url = url_for('landing', object_type=object_type, object_identifier=object_data.dataset_accession) %}
		{% set card_colsize = 'col-6' %}
		{% set image_colsize = 4 %}
		{% set max_description_length  = 100 %}
	{% elif object_type == 'tool' %}
		{% set card_title = object_data.tool_name %}
		{% set card_description = object_data.tool_description %}
		{% set card_icon_url = object_data.tool_icon_url %}
		{% set card_landing_url = url_for('landing', object_type=object_type, object_identifier=object_data.tool_name) %}
		{% set card_colsize = 'col-4' %}
		{% set image_colsize = 5 %}
		{% set max_description_length = 100 %}
	{% elif object_type == 'canned_analysis' %}
		{% set card_title = object_data.canned_analysis_title %}
		{% set card_source = 'maayanlab' %}
		{% set card_source_url = '#' %}
		{% set card_description = object_data.canned_analysis_description %}
		{% set card_icon_url = object_data.canned_analysis_preview_url %}
		{% set card_landing_url = url_for('landing', object_type=object_type, object_identifier=object_data.canned_analysis_accession) %}
		{% set card_colsize = 'col-6' %}
		{% set image_colsize = 5 %}
		{% set max_description_length = 100 %}
	{% endif %}

		<div class="{{ card_colsize }} card-col">
			<div class="card-wrapper {{object_type}}-card">
				<div class="row">
					<div class="col-{{ image_colsize }} card-icon-col">
						<a href="{{ card_landing_url }}"><img class="card-icon" src="{{ card_icon_url }}"></a>
					</div>
					<div class="col-{{ 12-image_colsize }} card-info-col">
						<a class="card-title" href="{{ card_landing_url }}">{{ card_title }}</a>
						{% if object_type == 'tool' %} <div class="tool-metrics">{{ '30 citations' }}</div> {% endif %}
						{% if object_type == 'dataset' or object_type == 'canned_analysis' %} <a href="{{ card_source_url }}" class="card-source">{{ card_source }}</a> {% endif %}
						<div class="card-description" data-toggle="tooltip" data-placement="bottom" data-animation="false" data-html="true" data-template='<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner card-description-tooltip"></div></div>' title="{{ card_description if card_description|length > max_description_length else ''}}">{{ card_description[:max_description_length]+'...' if card_description|length > max_description_length else card_description }}</div>
						<i class="fa fa-info-circle card-info-icon"></i>
					</div>
				</div>
			</div>
		</div>

{% endmacro %}

<!-- Search Results -->
{% macro display_filter_options(search_filters, object_type) %}
	{% set colsize = 'col-3' if object_type == 'canned_analysis' else 'col-4' %}
	{% for key, values in search_filters.iteritems() %}
		{% if key != 'canned_analysis_metadata' %}
			<div class="{{ colsize }}">
				<div class="search-option-label">{{ key.title() }}</div>
				<select data-placeholder="Select..." class="search-option-dropdown" name="{{ key }}">
					<option></option>
					{% for value in values %}
						<option value="{{ value }}"{{ ' selected' if request.args.get('tab') == object_type and request.args.get(key) == value else '' }}>{{ value }}</option>
					{% endfor %}
				</select>
			</div>
		{% endif %}
	{% endfor %}
{% endmacro %}

<!-- Search Results -->
{% macro display_search_results(search_filters, object_list, object_type) %}

	<div class="row search-results-wrapper">
		<div class="col-12">
			<div class="row search-filters-row">
				<div class="col-12">
					<div class="row search-row">
						<div class="col-6 text-left">
							<div class="form-inline">
								<input class="form-control" type="text" placeholder="Search..." name="q">
								<button class="btn" type="button">
									<i class="fa fa-search"></i>
								</button>
							</div>
						</div>
						<div class="col-6 text-right">
							<a class="filter-button">Filters&nbsp&nbsp</a>
						</div>
					</div>
					<div class="search-options-wrapper">
						<div class="row search-options-row">
							{{ display_filter_options(search_filters, object_type) }}
						</div>
					</div>
				</div>
			</div>
			<hr width="100%" class="my-1">
			<div class="row object-card-row">
				{% for object_data in object_list %}
					{{ display_object_card(object_data, object_type) }}
				{% endfor %}
			</div>
			<div class="row search-offsets-row">
				<div class="col-6 text-left">
					<span class="search-results-number">Displaying 3 of 3 results.</span>
				</div>
				<div class="col-6 text-right">
					<span class="search-filter-offset-label"> Pages: </span>
					{% for offset in [1,2,3] %}
						<input type="radio" name="offset" id="{{object_type}}-offset-{{offset}}" value="{{offset}}"{{ ' checked' if offset == 1}}>
						<label for="{{object_type}}-offset-{{offset}}" class="search-filter-offset">{{offset}}</label>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>

{% endmacro %}
